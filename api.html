
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Welcome to the API docs of the ShiftHappens benchmark! &#8212; Shift Happens (ICML 2022)  documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Accepted Papers" href="papers.html" />
    <link rel="prev" title="Call for Submissions" href="call_for_papers.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">Shift Happens (ICML 2022)  documentation</p>
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="call_for_papers.html">
  Call for Submissions
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="current reference internal nav-link" href="#">
  Benchmark API Docs
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="papers.html">
  Accepted Papers
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://shift-happens-benchmark.github.io/">Home<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/shift-happens-benchmark/iclr-2022" rel="noopener" target="_blank" title="Github"><span><i class="fab fa-github"></i></span>
            <label class="sr-only">Github</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://pypi.org/project/shifthappens/" rel="noopener" target="_blank" title="PyPI"><span><i class="fab fa-python"></i></span>
            <label class="sr-only">PyPI</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://join.slack.com/t/shifthappensicml2022/shared_invite/zt-16ewcukds-6jW6xC5DbtRvLCCkhZ~NLg" rel="noopener" target="_blank" title="Slack"><span><i class="fab fa-slack"></i></span>
            <label class="sr-only">Slack</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="mailto:shifthappens@bethgelab.org" rel="noopener" target="_blank" title="Contact us!"><span><i class="fas fa-envelope"></i></span>
            <label class="sr-only">Contact us!</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-shifthappens.benchmark">
   Benchmark
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-shifthappens.tasks.base">
     Task implementations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-shifthappens.data.imagenet">
   Accessing Scores for the ImageNet Validation Set
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-shifthappens.models.base">
     Model implementations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#module-shifthappens.models.torchvision">
       Model implementations from torchvision
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-shifthappens.data.base">
     Data loading
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-shifthappens.task_data.task_metadata">
     Storing tasks within the benchmark
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="welcome-to-the-api-docs-of-the-shifthappens-benchmark">
<h1>Welcome to the API docs of the ShiftHappens benchmark!<a class="headerlink" href="#welcome-to-the-api-docs-of-the-shifthappens-benchmark" title="Permalink to this heading">#</a></h1>
<p>We aim to create a community-built benchmark suite for ImageNet models comprised of new datasets for OOD robustness
and detection, as well as new tasks for existing OOD datasets.</p>
<p>While the popularity of robustness benchmarks and new test datasets
increased over the past years, the performance of computer vision models
is still largely evaluated on ImageNet directly, or on simulated or
isolated distribution shifts like in ImageNet-C.</p>
<p>The goal of this workshop is to enhance the landscape of robustness evaluation datasets for
computer vision and devise new test sets and metrics for quantifying desirable
properties of computer vision models. Our goal is to bring the robustness, domain
adaptation, and out-of-distribution detection communities together to work on a new
<strong>broad-scale benchmark</strong> that tests diverse aspects of current computer
vision models and guides the way towards the next generation of models.</p>
<p>Submissions to the workshop will be comprised of an addition of a <a class="reference internal" href="#shifthappens.tasks.base.Task" title="shifthappens.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code></a>, which will be used to test the performance
of various computer vision models on a new evaluation task you specify with your submission. Below we provide documentation
for the <code class="docutils literal notranslate"><span class="pre">shifthappens</span></code> API.</p>
<p>Also make sure to look at the <a class="reference external" href="https://github.com/shift-happens-benchmark/icml-2022/tree/main/examples">examples</a>
in the github repository. If in doubt or if the API is not yet sufficiently flexible to fit your needs, consider
opening an issue on github or join our slack channel.</p>
<section id="module-shifthappens.benchmark">
<span id="benchmark"></span><h2>Benchmark<a class="headerlink" href="#module-shifthappens.benchmark" title="Permalink to this heading">#</a></h2>
<p>Base functions to register new tasks to the benchmark and evaluate models.</p>
<p>To register add a new task decorate a task class inherited from
<a class="reference internal" href="#shifthappens.tasks.base.Task" title="shifthappens.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.tasks.base.Task</span></code></a> with <a class="reference internal" href="#shifthappens.benchmark.register_task" title="shifthappens.benchmark.register_task"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shifthappens.benchmark.register_task</span></code></a>
function.</p>
<p>To evaluate model on all the registered tasks run
<a class="reference internal" href="#shifthappens.benchmark.evaluate_model" title="shifthappens.benchmark.evaluate_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shifthappens.benchmark.evaluate_model</span></code></a>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="shifthappens.benchmark.evaluate_model">
<span class="sig-prename descclassname"><span class="pre">shifthappens.benchmark.</span></span><span class="sig-name descname"><span class="pre">evaluate_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/benchmark.html#evaluate_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.benchmark.evaluate_model" title="Permalink to this definition">#</a></dt>
<dd><p>Runs all registered tasks of the benchmark
which are supported by the supplied model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#shifthappens.models.base.Model" title="shifthappens.models.base.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Model to evaluate.</p></li>
<li><p><strong>data_root</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Folder where individual tasks can store their data.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference internal" href="#shifthappens.task_data.task_registration.TaskRegistration" title="shifthappens.task_data.task_registration.TaskRegistration"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskRegistration</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#shifthappens.tasks.task_result.TaskResult" title="shifthappens.tasks.task_result.TaskResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskResult</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Associates <a class="reference internal" href="#shifthappens.task_data.task_metadata.TaskMetadata" title="shifthappens.task_data.task_metadata.TaskMetadata"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.task_data.task_metadata.TaskMetadata</span></code></a> with the
respective <a class="reference internal" href="#shifthappens.tasks.task_result.TaskResult" title="shifthappens.tasks.task_result.TaskResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.tasks.task_result.TaskResult</span></code></a>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shifthappens.benchmark</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">shifthappens.models.torchvision</span> <span class="kn">import</span> <span class="n">resnet18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import existing model or create a custom one inherited from</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># shifthappens.models.base.Model and ModelMixin&#39;s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">resnet18</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shifthappens</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;path_to_store_tasks_data&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shifthappens.benchmark.register_task">
<span class="sig-prename descclassname"><span class="pre">shifthappens.benchmark.</span></span><span class="sig-name descname"><span class="pre">register_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_data_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standalone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/benchmark.html#register_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.benchmark.register_task" title="Permalink to this definition">#</a></dt>
<dd><p>Registers a task class inherited from <a class="reference internal" href="#shifthappens.tasks.base.Task" title="shifthappens.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.tasks.base.Task</span></code></a>
as task as part of the benchmark.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the task (can contain spaces or special characters).</p></li>
<li><p><strong>relative_data_folder</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the folder in which the data for
this dataset will be saved for this task relative to the root folder
of the benchmark.</p></li>
<li><p><strong>standalone</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Boolean which represents if this task meaningful as a
standalone task or will this only be relevant as a part of a
collection of tasks.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@shifthappens</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">register_task</span><span class="p">(</span>
<span class="go">        name=&quot;CustomTask&quot;,</span>
<span class="go">        relative_data_folder=&quot;path_to_store_task_data&quot;,</span>
<span class="go">        standalone=True</span>
<span class="go">    )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">CustomTaskClass</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
<span class="go">        ...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shifthappens.benchmark.get_registered_tasks">
<span class="sig-prename descclassname"><span class="pre">shifthappens.benchmark.</span></span><span class="sig-name descname"><span class="pre">get_registered_tasks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/benchmark.html#get_registered_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.benchmark.get_registered_tasks" title="Permalink to this definition">#</a></dt>
<dd><p>All tasks currently registered as part of the benchmark.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code></a>[<a class="reference internal" href="#shifthappens.tasks.base.Task" title="shifthappens.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code></a>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of all currently registered tasks as part of the benchmark. This
tuple used for task iteration in <a class="reference internal" href="#shifthappens.benchmark.evaluate_model" title="shifthappens.benchmark.evaluate_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shifthappens.benchmark.evaluate_model</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<section id="module-shifthappens.tasks.base">
<span id="task-implementations"></span><h3>Task implementations<a class="headerlink" href="#module-shifthappens.tasks.base" title="Permalink to this heading">#</a></h3>
<p>Base definition of a task in the shift happens benchmark.</p>
<p>Fully defined tasks should subclass the <a class="reference internal" href="#shifthappens.tasks.base.Task" title="shifthappens.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code></a> abstract base class, and implement all
mixins based on the required model outputs to evaluate the task, also part of this module.</p>
<p>Implementing a new task consists of the following steps:</p>
<ol class="arabic simple">
<li><p>Subclass the <a class="reference internal" href="#shifthappens.tasks.base.Task" title="shifthappens.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code></a> class and implement its abstract methods to specify the task
setup and evaluation scheme</p></li>
<li><p>Implement any number of mixins specified in <a class="reference internal" href="#module-shifthappens.tasks.mixins" title="shifthappens.tasks.mixins"><code class="xref py py-mod docutils literal notranslate"><span class="pre">shifthappens.tasks.mixins</span></code></a>. You just need to include
the mixin in the class definition, e.g. <code class="docutils literal notranslate"><span class="pre">class</span> <span class="pre">MyTask(Task,</span> <span class="pre">ConfidenceTaskMixin)</span></code>,
and do not need to implement additional methods. By specifying the mixin, it will be
assured that your task gets the correct model outputs.
See the individual mixin classes, or the <a class="reference internal" href="#shifthappens.models.base.ModelResult" title="shifthappens.models.base.ModelResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelResult</span></code></a>
class for further details.</p></li>
<li><p>Register your class to the benchmark using the <a class="reference internal" href="#shifthappens.benchmark.register_task" title="shifthappens.benchmark.register_task"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_task</span></code></a>
decorator, along with a name and data path for your benchmark.</p></li>
</ol>
<dl class="py data">
<dt class="sig sig-object py" id="shifthappens.tasks.base.T">
<span class="sig-prename descclassname"><span class="pre">shifthappens.tasks.base.</span></span><span class="sig-name descname"><span class="pre">T</span></span><a class="headerlink" href="#shifthappens.tasks.base.T" title="Permalink to this definition">#</a></dt>
<dd><p>A generic representing arbitrary types.</p>
<p>alias of TypeVar(‘T’)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shifthappens.tasks.base.parameter">
<span class="sig-prename descclassname"><span class="pre">shifthappens.tasks.base.</span></span><span class="sig-name descname"><span class="pre">parameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/tasks/base.html#parameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.base.parameter" title="Permalink to this definition">#</a></dt>
<dd><p>Register a task’s parameter. Setting multiple options here allows automatically
creating different flavours of the task. Use this field for storing values of a hyperparameter
if you want to run task with different hyperparameter. For example, you can use this mechanism
to create tasks with varying difficulties without creating multiple classes/tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>default</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a>(<code class="docutils literal notranslate"><span class="pre">T</span></code>)) – default value.</p></li>
<li><p><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a>(<code class="docutils literal notranslate"><span class="pre">T</span></code>), <a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code></a>]) – allowed options.</p></li>
<li><p><strong>description</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – short description.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">CustomTask</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">max_batch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">shifthappens</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">parameter</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">default</span><span class="o">=</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="kc">None</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">options</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="c1">#None corresponds to dataset-sized batch</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;maximum size of batches fed to the model during evaluation&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">)</span>
<span class="go">        ...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shifthappens.tasks.base.variable">
<span class="sig-prename descclassname"><span class="pre">shifthappens.tasks.base.</span></span><span class="sig-name descname"><span class="pre">variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/tasks/base.html#variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.base.variable" title="Permalink to this definition">#</a></dt>
<dd><p>Creates a non-parametric variable for a task, i.e. its value won’t be passed to the constructor.
Use it to store constants such as links to the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a>(<code class="docutils literal notranslate"><span class="pre">T</span></code>)) – value of the constant.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">CustomTask</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">constant</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">shifthappens</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">variable</span><span class="p">(</span><span class="s2">&quot;your constant&quot;</span><span class="p">)</span>
<span class="go">        ...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shifthappens.tasks.base.abstract_variable">
<span class="sig-prename descclassname"><span class="pre">shifthappens.tasks.base.</span></span><span class="sig-name descname"><span class="pre">abstract_variable</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/tasks/base.html#abstract_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.base.abstract_variable" title="Permalink to this definition">#</a></dt>
<dd><p>Marks a variable as abstract such that a child class needs to override it
with a non-abstract variable. See <a class="reference internal" href="#shifthappens.tasks.base.variable" title="shifthappens.tasks.base.variable"><code class="xref py py-func docutils literal notranslate"><span class="pre">variable</span></code></a> for the non-abstract
counterpart.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">CustomTask</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">constant</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">shifthappens</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">abstract_variable</span><span class="p">()</span>
<span class="go">        ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">InheritedTask</span><span class="p">(</span><span class="n">CustomTask</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">constant</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">shifthappens</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">variable</span><span class="p">(</span><span class="s2">&quot;your constant&quot;</span><span class="p">)</span>
<span class="go">        ...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.tasks.base.Task">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.tasks.base.</span></span><span class="sig-name descname"><span class="pre">Task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/tasks/base.html#Task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.base.Task" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Task base class.</p>
<p>Override the <a class="reference internal" href="#shifthappens.tasks.base.Task.setup" title="shifthappens.tasks.base.Task.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup</span></code></a>, <a class="reference internal" href="#shifthappens.tasks.base.Task._prepare_dataloader" title="shifthappens.tasks.base.Task._prepare_dataloader"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_prepare_dataloader</span></code></a> and <a class="reference internal" href="#shifthappens.tasks.base.Task._evaluate" title="shifthappens.tasks.base.Task._evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_evaluate</span></code></a> methods to define
your task. Also make sure to add in additional mixins from <a class="reference internal" href="#module-shifthappens.tasks.base" title="shifthappens.tasks.base"><code class="xref py py-mod docutils literal notranslate"><span class="pre">shifthappens.tasks.base</span></code></a> to specify
which models your task is compatible to (e.g., specify that your task needs labels, or confidences from
a model).</p>
<p>To include the task in the benchmark, use the <a class="reference internal" href="#shifthappens.benchmark.register_task" title="shifthappens.benchmark.register_task"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_task</span></code></a>
decorator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_root</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Folder where individual tasks can store their data.
This field is initialized with the value passed to
<a class="reference internal" href="#shifthappens.benchmark.evaluate_model" title="shifthappens.benchmark.evaluate_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shifthappens.benchmark.evaluate_model</span></code></a>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="shifthappens.tasks.base.Task.iterate_flavours">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">iterate_flavours</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/tasks/base.html#Task.iterate_flavours"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.base.Task.iterate_flavours" title="Permalink to this definition">#</a></dt>
<dd><p>Iterate over all possible task configurations,
i.e. different settings of parameter fields. Parameters should be defined
with <a class="reference internal" href="#shifthappens.tasks.base.parameter" title="shifthappens.tasks.base.parameter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shifthappens.tasks.base.parameter</span></code></a>, where <code class="docutils literal notranslate"><span class="pre">options</span></code> argument
corresponds to possible configurations of particular parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterator</span></code></a>[<a class="reference internal" href="#shifthappens.tasks.base.Task" title="shifthappens.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shifthappens.tasks.base.Task.setup">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/tasks/base.html#Task.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.base.Task.setup" title="Permalink to this definition">#</a></dt>
<dd><p>Set the task up, i.e., download, load and prepare the dataset.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># imagenet_r example</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@shifthappens</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">register_task</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">ImageNetR</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">dataset_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_root</span><span class="p">,</span> <span class="s2">&quot;imagenet-r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dataset_folder</span><span class="p">):</span> <span class="c1"># download data</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="k">for</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">md5</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">sh_utils</span><span class="o">.</span><span class="n">download_and_extract_archive</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>                    <span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_root</span><span class="p">,</span> <span class="n">md5</span><span class="p">,</span> <span class="n">file_name</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shifthappens.tasks.base.Task.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/tasks/base.html#Task.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.base.Task.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Validates that the model is compatible with the task and then evaluates the model’s
performance using the <a class="reference internal" href="#shifthappens.tasks.base.Task._evaluate" title="shifthappens.tasks.base.Task._evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_evaluate</span></code></a> function of this class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference internal" href="#shifthappens.models.base.Model" title="shifthappens.models.base.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – The model to evaluate.
See <a class="reference internal" href="#shifthappens.tasks.base.Task._evaluate" title="shifthappens.tasks.base.Task._evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_evaluate</span></code></a> for more details.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#shifthappens.tasks.task_result.TaskResult" title="shifthappens.tasks.task_result.TaskResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskResult</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shifthappens.tasks.base.Task._prepare_dataloader">
<span class="sig-name descname"><span class="pre">_prepare_dataloader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/tasks/base.html#Task._prepare_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.base.Task._prepare_dataloader" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare a <a class="reference internal" href="#shifthappens.data.base.DataLoader" title="shifthappens.data.base.DataLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.data.base.DataLoader</span></code></a> based on just the <em>unlabeled</em> images which will be passed to the model
before the actual evaluation. This allows models to, e.g., run unsupervised domain adaptation techniques.
This method can be used to give models access to the unlabeled data in case they want to run some
kind of unsupervised adaptation mechanism such as re-calibration.</p>
<p>Note that this function could also be used to introduce domain shifts for such adaptation methods, by creating
a different dataloader in this prepare function than used during <a class="reference internal" href="#shifthappens.tasks.base.Task.evaluate" title="shifthappens.tasks.base.Task.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate</span></code></a>.</p>
<p>By default no <cite>DataLoader &lt;shifthappens.data.base.DataLoader&gt;</cite> is returned, i.e., the models do not get access to the unlabeled data.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">CustomTask</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">_prepare_dataloader</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">return</span> <span class="n">shifthappens</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">max_batch_size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#shifthappens.data.base.DataLoader" title="shifthappens.data.base.DataLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shifthappens.tasks.base.Task._evaluate">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/tasks/base.html#Task._evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.base.Task._evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the task and return a dictionary with the calculated metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference internal" href="#shifthappens.models.base.Model" title="shifthappens.models.base.Model"><em>shifthappens.models.base.Model</em></a>) – The passed model implements a <code class="docutils literal notranslate"><span class="pre">predict</span></code> function returning an iterator
over <a class="reference internal" href="#shifthappens.models.base.ModelResult" title="shifthappens.models.base.ModelResult"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shifthappens.models.base.ModelResult</span></code></a>. Each result contains predictions such as
the class labels assigned to the images, confidences, etc., based on which mixins were
implemented by this task to request these prediction outputs.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The results of the task in the
form of a <a class="reference internal" href="#shifthappens.tasks.task_result.TaskResult" title="shifthappens.tasks.task_result.TaskResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.tasks.task_result.TaskResult</span></code></a> containing an
arbitrary dictionary of metrics, along with a specification of which of these
metrics are main results/summary metrics for the task.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shifthappens.tasks.task_result.TaskResult" title="shifthappens.tasks.task_result.TaskResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.tasks.task_result.TaskResult</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># imagenet_r example</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@shifthappens</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">register_task</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">ImageNetR</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">def</span> <span class="nf">_evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">shifthappens</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaskResult</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">dataloader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_dataloader</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">all_predicted_labels_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="k">for</span> <span class="n">predictions</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">dataloader</span><span class="p">,</span> <span class="n">PredictionTargets</span><span class="p">(</span><span class="n">class_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">all_predicted_labels_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">class_labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">all_predicted_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">all_predicted_labels_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">accuracy</span> <span class="o">=</span> <span class="n">all_predicted_labels</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ch_dataset</span><span class="o">.</span><span class="n">targets</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="k">return</span> <span class="n">TaskResult</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">accuracy</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">summary_metrics</span><span class="o">=</span><span class="p">{</span><span class="n">Metric</span><span class="o">.</span><span class="n">Robustness</span><span class="p">:</span> <span class="s2">&quot;accuracy&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">...</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<span class="target" id="module-shifthappens.tasks.mixins"></span><p>Task mixins indicate the requirements of the task on the model in terms of the
model’s supported prediction types.</p>
<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.tasks.mixins.LabelTaskMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.tasks.mixins.</span></span><span class="sig-name descname"><span class="pre">LabelTaskMixin</span></span><a class="reference internal" href="_modules/shifthappens/tasks/mixins.html#LabelTaskMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.mixins.LabelTaskMixin" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Indicates that the task requires the model to return the predicted labels.</p>
<p>Tasks implementing this mixin will be provided with the <code class="docutils literal notranslate"><span class="pre">class_labels</span></code> attribute in the
<a class="reference internal" href="#shifthappens.models.base.ModelResult" title="shifthappens.models.base.ModelResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.models.base.ModelResult</span></code></a> returned during evaluation.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.tasks.mixins.ConfidenceTaskMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.tasks.mixins.</span></span><span class="sig-name descname"><span class="pre">ConfidenceTaskMixin</span></span><a class="reference internal" href="_modules/shifthappens/tasks/mixins.html#ConfidenceTaskMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.mixins.ConfidenceTaskMixin" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Indicates that the task requires the model to return the confidence scores.</p>
<p>Tasks implementing this mixin will be provided with the <code class="docutils literal notranslate"><span class="pre">confidences</span></code> attribute in the
<a class="reference internal" href="#shifthappens.models.base.ModelResult" title="shifthappens.models.base.ModelResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.models.base.ModelResult</span></code></a> returned during evaluation.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.tasks.mixins.UncertaintyTaskMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.tasks.mixins.</span></span><span class="sig-name descname"><span class="pre">UncertaintyTaskMixin</span></span><a class="reference internal" href="_modules/shifthappens/tasks/mixins.html#UncertaintyTaskMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.mixins.UncertaintyTaskMixin" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Indicates that the task requires the model to return the uncertainty scores.</p>
<p>Tasks implementing this mixin will be provided with the <code class="docutils literal notranslate"><span class="pre">uncertainties</span></code> attribute in the
<a class="reference internal" href="#shifthappens.models.base.ModelResult" title="shifthappens.models.base.ModelResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.models.base.ModelResult</span></code></a> returned during evaluation.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.tasks.mixins.OODScoreTaskMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.tasks.mixins.</span></span><span class="sig-name descname"><span class="pre">OODScoreTaskMixin</span></span><a class="reference internal" href="_modules/shifthappens/tasks/mixins.html#OODScoreTaskMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.mixins.OODScoreTaskMixin" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Indicates that the task requires the model to return the OOD scores.</p>
<p>Tasks implementing this mixin will be provided with the <code class="docutils literal notranslate"><span class="pre">ood_scores</span></code> attribute in the
<a class="reference internal" href="#shifthappens.models.base.ModelResult" title="shifthappens.models.base.ModelResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.models.base.ModelResult</span></code></a> returned during evaluation.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.tasks.mixins.FeaturesTaskMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.tasks.mixins.</span></span><span class="sig-name descname"><span class="pre">FeaturesTaskMixin</span></span><a class="reference internal" href="_modules/shifthappens/tasks/mixins.html#FeaturesTaskMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.mixins.FeaturesTaskMixin" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Indicates that the task requires the model to return the raw features.</p>
<p>Tasks implementing this mixin will be provided with the <code class="docutils literal notranslate"><span class="pre">features</span></code> attribute in the
<a class="reference internal" href="#shifthappens.models.base.ModelResult" title="shifthappens.models.base.ModelResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.models.base.ModelResult</span></code></a> returned during evaluation.</p>
</dd></dl>

<span class="target" id="module-shifthappens.tasks.task_result"></span><dl class="py class">
<dt class="sig sig-object py" id="shifthappens.tasks.task_result.TaskResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.tasks.task_result.</span></span><span class="sig-name descname"><span class="pre">TaskResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summary_metrics</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">metrics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/tasks/task_result.html#TaskResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.task_result.TaskResult" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Contains the results of a result, which can be arbitrary metrics.
At least one of these metrics must be references as a summary metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>summary_metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference internal" href="#shifthappens.tasks.metrics.Metric" title="shifthappens.tasks.metrics.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code></a>]]]) – Associates <a class="reference internal" href="#shifthappens.tasks.metrics.Metric" title="shifthappens.tasks.metrics.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.tasks.metrics.Metric</span></code></a> values
to the name of metrics calculated by the task.</p></li>
<li><p><strong>metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – Metrics’ names and their values.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">CustomTask</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">_evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">shifthappens</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">return</span> <span class="n">TaskResult</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">your_robustness_metric</span><span class="o">=</span><span class="n">your_robustness_metric</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">your_calibration_metric</span><span class="o">=</span><span class="n">your_calibration_metric</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">your_custom_metric</span><span class="o">=</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">your_custom_metric</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">summary_metrics</span><span class="o">=</span><span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">Metric</span><span class="o">.</span><span class="n">Robustness</span><span class="p">:</span> <span class="s2">&quot;your_robustness_metric&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">Metric</span><span class="o">.</span><span class="n">Calibration</span><span class="p">:</span> <span class="s2">&quot;your_calibration_metric&quot;</span><span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-shifthappens.tasks.metrics"></span><p>Categories in which metrics of tasks will be grouped.</p>
<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.tasks.metrics.Metric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.tasks.metrics.</span></span><span class="sig-name descname"><span class="pre">Metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/tasks/metrics.html#Metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.tasks.metrics.Metric" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.IntEnum" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntEnum</span></code></a></p>
<p>Categories which will be used to aggregate and average over  the results of various tasks in the benchmark.</p>
</dd></dl>

</section>
</section>
<section id="module-shifthappens.data.imagenet">
<span id="accessing-scores-for-the-imagenet-validation-set"></span><h2>Accessing Scores for the ImageNet Validation Set<a class="headerlink" href="#module-shifthappens.data.imagenet" title="Permalink to this heading">#</a></h2>
<p>This module provides functionality to access the predictions of a model for the ImageNet validation set.
Further, the predictions can be cached and loaded from the cache to reduce computational costs.
Note, that for this to work :py:data:shifthappens.data.imagenet.ImageNetValidationData
must be set to the ImageNet validation set path. path.</p>
<dl class="py data">
<dt class="sig sig-object py" id="shifthappens.data.imagenet.ImageNetValidationData">
<span class="sig-prename descclassname"><span class="pre">shifthappens.data.imagenet.</span></span><span class="sig-name descname"><span class="pre">ImageNetValidationData</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'shifthappens/imagenet'</span></em><a class="headerlink" href="#shifthappens.data.imagenet.ImageNetValidationData" title="Permalink to this definition">#</a></dt>
<dd><p>Must be set to ImageNet validation set path (either absolute or relative to working directory).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="shifthappens.data.imagenet.ImageNetValidationPredictionsCache">
<span class="sig-prename descclassname"><span class="pre">shifthappens.data.imagenet.</span></span><span class="sig-name descname"><span class="pre">ImageNetValidationPredictionsCache</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'shifthappens/cache'</span></em><a class="headerlink" href="#shifthappens.data.imagenet.ImageNetValidationPredictionsCache" title="Permalink to this definition">#</a></dt>
<dd><p>Must be set to models’ results caching directory (either absolute or relative to working directory). If the folder does not exist, it will be created.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shifthappens.data.imagenet.get_imagenet_validation_loader">
<span class="sig-prename descclassname"><span class="pre">shifthappens.data.imagenet.</span></span><span class="sig-name descname"><span class="pre">get_imagenet_validation_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/data/imagenet.html#get_imagenet_validation_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.data.imagenet.get_imagenet_validation_loader" title="Permalink to this definition">#</a></dt>
<dd><p>Creates a <a class="reference internal" href="#shifthappens.data.base.DataLoader" title="shifthappens.data.base.DataLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.data.base.DataLoader</span></code></a> for the validation set of ImageNet.
Note that the path to ImageNet validation set
<a class="reference internal" href="#shifthappens.data.imagenet.ImageNetValidationData" title="shifthappens.data.imagenet.ImageNetValidationData"><code class="xref py py-data docutils literal notranslate"><span class="pre">shifthappens.data.imagenet.ImageNetValidationData</span></code></a> must be specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>max_batch_size</strong> – How many samples allowed per batch to load.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#shifthappens.data.base.DataLoader" title="shifthappens.data.base.DataLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ImageNet validation set data loader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shifthappens.data.imagenet.get_cached_predictions">
<span class="sig-prename descclassname"><span class="pre">shifthappens.data.imagenet.</span></span><span class="sig-name descname"><span class="pre">get_cached_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/data/imagenet.html#get_cached_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.data.imagenet.get_cached_predictions" title="Permalink to this definition">#</a></dt>
<dd><p>Checks whether there exist cached results for the model’s class and if so, returns them.
Note that the path to ImageNet validation set
<a class="reference internal" href="#shifthappens.data.imagenet.ImageNetValidationData" title="shifthappens.data.imagenet.ImageNetValidationData"><code class="xref py py-data docutils literal notranslate"><span class="pre">shifthappens.data.imagenet.ImageNetValidationData</span></code></a> must be specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cls</strong> – Model’s class. Used for specifying folder name.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of loaded model predictions on ImageNet validation set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shifthappens.data.imagenet.cache_predictions">
<span class="sig-prename descclassname"><span class="pre">shifthappens.data.imagenet.</span></span><span class="sig-name descname"><span class="pre">cache_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imagenet_validation_result</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/data/imagenet.html#cache_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.data.imagenet.cache_predictions" title="Permalink to this definition">#</a></dt>
<dd><p>Caches model predictions in cls-named folder and load
model predictions from it. Note that the path to ImageNet validation set
<a class="reference internal" href="#shifthappens.data.imagenet.ImageNetValidationData" title="shifthappens.data.imagenet.ImageNetValidationData"><code class="xref py py-data docutils literal notranslate"><span class="pre">shifthappens.data.imagenet.ImageNetValidationData</span></code></a> must be specified as
well as <a class="reference internal" href="#shifthappens.data.imagenet.ImageNetValidationPredictionsCache" title="shifthappens.data.imagenet.ImageNetValidationPredictionsCache"><code class="xref py py-data docutils literal notranslate"><span class="pre">shifthappens.data.imagenet.ImageNetValidationPredictionsCache</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> – Model’s class. Used for specifying folder name.</p></li>
<li><p><strong>imagenet_validation_result</strong> (<a class="reference internal" href="#shifthappens.models.base.ModelResult" title="shifthappens.models.base.ModelResult"><em>ModelResult</em></a>) – Model’s prediction on ImageNet
validation set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shifthappens.data.imagenet.is_cached">
<span class="sig-prename descclassname"><span class="pre">shifthappens.data.imagenet.</span></span><span class="sig-name descname"><span class="pre">is_cached</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/data/imagenet.html#is_cached"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.data.imagenet.is_cached" title="Permalink to this definition">#</a></dt>
<dd><p>Checks if model’s results are cached in cls-named folder. Note that the path to the ImageNet validation set
<a class="reference internal" href="#shifthappens.data.imagenet.ImageNetValidationData" title="shifthappens.data.imagenet.ImageNetValidationData"><code class="xref py py-data docutils literal notranslate"><span class="pre">shifthappens.data.imagenet.ImageNetValidationData</span></code></a> must be specified as
well as <a class="reference internal" href="#shifthappens.data.imagenet.ImageNetValidationPredictionsCache" title="shifthappens.data.imagenet.ImageNetValidationPredictionsCache"><code class="xref py py-data docutils literal notranslate"><span class="pre">shifthappens.data.imagenet.ImageNetValidationPredictionsCache</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cls</strong> – Model’s class. Used for specifying folder name.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if model’s results are cached, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shifthappens.data.imagenet.load_imagenet_targets">
<span class="sig-prename descclassname"><span class="pre">shifthappens.data.imagenet.</span></span><span class="sig-name descname"><span class="pre">load_imagenet_targets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/data/imagenet.html#load_imagenet_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.data.imagenet.load_imagenet_targets" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the ground-truth labels of the ImageNet valdation set.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<section id="module-shifthappens.models.base">
<span id="model-implementations"></span><h3>Model implementations<a class="headerlink" href="#module-shifthappens.models.base" title="Permalink to this heading">#</a></h3>
<p>Base classes and helper functions for adding models to the benchmark.</p>
<p>To add a new model, implement a new wrapper class inheriting from
<a class="reference internal" href="#shifthappens.models.base.Model" title="shifthappens.models.base.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.models.base.Model</span></code></a>, and from any of the Mixins defined
in <a class="reference internal" href="#module-shifthappens.models.mixins" title="shifthappens.models.mixins"><code class="xref py py-mod docutils literal notranslate"><span class="pre">shifthappens.models.mixins</span></code></a>.</p>
<p>Model results should be converted to <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> objects, and
packed into an <a class="reference internal" href="#shifthappens.models.base.ModelResult" title="shifthappens.models.base.ModelResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">shifthappens.models.base.ModelResult</span></code></a> instance.</p>
<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.models.base.ModelResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.models.base.</span></span><span class="sig-name descname"><span class="pre">ModelResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidences</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ood_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/models/base.html#ModelResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.base.ModelResult" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Emissions of a model after processing a batch of data.</p>
<p>Each model needs to return class labels that are compatible with
the ILSRC2012 labels. We use the same convention used by PyTorch
regarding the ordering of labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_labels</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">k)</span></code>, top-k predictions for
each sample in the batch. Choice of <code class="docutils literal notranslate"><span class="pre">k</span></code> can be selected by
the user, and potentially influences the type of accuracy
based benchmarks that the model can be run on. For standard
ImageNet, ImageNet-C evaluation, choose at least <code class="docutils literal notranslate"><span class="pre">k=5</span></code>.</p></li>
<li><p><strong>confidences</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">1000)</span></code>, confidences for each class.
Standard PyTorch ImageNet class label order is expected for
this array. Scores can be in the range <code class="docutils literal notranslate"><span class="pre">-inf</span></code> to <code class="docutils literal notranslate"><span class="pre">inf</span></code>.</p></li>
<li><p><strong>uncertainties</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">1000)</span></code>, uncertainties for the
different class predictions. Different from the <code class="docutils literal notranslate"><span class="pre">confidences</span></code>,
this is a measure of certainty of the given <code class="docutils literal notranslate"><span class="pre">confidences</span></code> and
common e.g. in Bayesian Deep neural networks.</p></li>
<li><p><strong>ood_scores</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – <code class="docutils literal notranslate"><span class="pre">(N,)</span></code>, score for interpreting the sample
as an out-of-distribution class, in the range <code class="docutils literal notranslate"><span class="pre">-inf</span></code> to <code class="docutils literal notranslate"><span class="pre">inf</span></code>.</p></li>
<li><p><strong>features</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">d)</span></code>, where <code class="docutils literal notranslate"><span class="pre">d</span></code> can be arbitrary, feature
representation used to arrive at the given predictions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.models.base.PredictionTargets">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.models.base.</span></span><span class="sig-name descname"><span class="pre">PredictionTargets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidences</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ood_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/models/base.html#PredictionTargets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.base.PredictionTargets" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Contains boolean flags of which type of targets model is predicting. Note
that at least one flag should be set as <code class="docutils literal notranslate"><span class="pre">True</span></code> and model should be inherited
from corresponding ModelMixin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if model returns predicted labels.</p></li>
<li><p><strong>confidences</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if model returns confidences.</p></li>
<li><p><strong>uncertainties</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if model returns uncertainties.</p></li>
<li><p><strong>ood_scores</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if model returns ood scores.</p></li>
<li><p><strong>features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if model returns features.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.models.base.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.models.base.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><a class="reference internal" href="_modules/shifthappens/models/base.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.base.Model" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Model base class.</p>
<p>Override the <a class="reference internal" href="#shifthappens.models.base.Model._predict" title="shifthappens.models.base.Model._predict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_predict</span></code></a> method to define predictions type of your specific model.
If your model uses unsupervised adaptation mechanisms override <a class="reference internal" href="#shifthappens.models.base.Model.prepare" title="shifthappens.models.base.Model.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare</span></code></a>
as well.</p>
<p>Also make sure that your model inherits from the mixins from <a class="reference internal" href="#module-shifthappens.models.mixins" title="shifthappens.models.mixins"><code class="xref py py-mod docutils literal notranslate"><span class="pre">shifthappens.models.mixins</span></code></a>
corresponding to your model predictions type (e.g., <a class="reference internal" href="#shifthappens.models.mixins.LabelModelMixin" title="shifthappens.models.mixins.LabelModelMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">LabelModelMixin</span></code></a> for labels
or <a class="reference internal" href="#shifthappens.models.mixins.ConfidenceModelMixin" title="shifthappens.models.mixins.ConfidenceModelMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfidenceModelMixin</span></code></a> for confidences).</p>
<dl class="py property">
<dt class="sig sig-object py" id="shifthappens.models.base.Model.imagenet_validation_result">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">imagenet_validation_result</span></span><a class="headerlink" href="#shifthappens.models.base.Model.imagenet_validation_result" title="Permalink to this definition">#</a></dt>
<dd><p>Access the model’s predictions/evaluation results on the ImageNet validation set.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Model evaluation result on ImageNet validation set wrapped with ModelResult.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shifthappens.models.base.Model.prepare">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/models/base.html#Model.prepare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.base.Model.prepare" title="Permalink to this definition">#</a></dt>
<dd><p>If the model uses unsupervised adaptation mechanisms, it will run those.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataloader</strong> (<a class="reference internal" href="#shifthappens.data.base.DataLoader" title="shifthappens.data.base.DataLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></a>) – Dataloader producing batches of data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shifthappens.models.base.Model.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/models/base.html#Model.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.base.Model.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Yield all the predictions of the model for all data samples contained
in the dataloader</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dataloader</strong> (<a class="reference internal" href="#shifthappens.data.base.DataLoader" title="shifthappens.data.base.DataLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></a>) – Dataloader producing batches of data.</p></li>
<li><p><strong>targets</strong> (<a class="reference internal" href="#shifthappens.models.base.PredictionTargets" title="shifthappens.models.base.PredictionTargets"><code class="xref py py-class docutils literal notranslate"><span class="pre">PredictionTargets</span></code></a>) – Indicates which kinds of targets should
be predicted.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterator</span></code></a>[<a class="reference internal" href="#shifthappens.models.base.ModelResult" title="shifthappens.models.base.ModelResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelResult</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Prediction results for the given batch. Depending on the target
arguments this includes the predicted labels, class confidences,
class uncertainties, ood scores, and image features, all as
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> objects.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shifthappens.models.base.Model._get_imagenet_predictions">
<span class="sig-name descname"><span class="pre">_get_imagenet_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rewrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/models/base.html#Model._get_imagenet_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.base.Model._get_imagenet_predictions" title="Permalink to this definition">#</a></dt>
<dd><p>Loads cached predictions on ImageNet validation set for the model or predicts
on ImageNet validation set and caches the result whenever there is no cached
predictions for the model or <code class="docutils literal notranslate"><span class="pre">rewrite</span></code> argument set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rewrite</strong> – <code class="docutils literal notranslate"><span class="pre">True</span></code> if models predictions need to be rewritten.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shifthappens.models.base.Model._predict_imagenet_val">
<span class="sig-name descname"><span class="pre">_predict_imagenet_val</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/models/base.html#Model._predict_imagenet_val"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.base.Model._predict_imagenet_val" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluates model on ImageNet validation set and store all possible targets scores
for the particular model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shifthappens.models.base.Model._predict">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/models/base.html#Model._predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.base.Model._predict" title="Permalink to this definition">#</a></dt>
<dd><p>Override this function for the specific model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dataloader</strong> (<a class="reference internal" href="#shifthappens.data.base.DataLoader" title="shifthappens.data.base.DataLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></a>) – Dataloader producing batches of data.</p></li>
<li><p><strong>targets</strong> (<a class="reference internal" href="#shifthappens.models.base.PredictionTargets" title="shifthappens.models.base.PredictionTargets"><code class="xref py py-class docutils literal notranslate"><span class="pre">PredictionTargets</span></code></a>) – Indicates which kinds of targets should be predicted.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterator</span></code></a>[<a class="reference internal" href="#shifthappens.models.base.ModelResult" title="shifthappens.models.base.ModelResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelResult</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Yields prediction results for all batches yielded by the dataloader.
Depending on the target arguments the model results may include the
predicted labels, class confidences, class uncertainties, ood scores,
and image features, all as <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> objects.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-shifthappens.models.mixins"></span><p>Model mixins indicate the supported prediction types of a model.</p>
<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.models.mixins.LabelModelMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.models.mixins.</span></span><span class="sig-name descname"><span class="pre">LabelModelMixin</span></span><a class="reference internal" href="_modules/shifthappens/models/mixins.html#LabelModelMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.mixins.LabelModelMixin" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Inherit from this class if your model returns predicted labels.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.models.mixins.ConfidenceModelMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.models.mixins.</span></span><span class="sig-name descname"><span class="pre">ConfidenceModelMixin</span></span><a class="reference internal" href="_modules/shifthappens/models/mixins.html#ConfidenceModelMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.mixins.ConfidenceModelMixin" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Inherit from this class if your model returns confidences.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.models.mixins.UncertaintyModelMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.models.mixins.</span></span><span class="sig-name descname"><span class="pre">UncertaintyModelMixin</span></span><a class="reference internal" href="_modules/shifthappens/models/mixins.html#UncertaintyModelMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.mixins.UncertaintyModelMixin" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Inherit from this class if your model returns uncertainties.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.models.mixins.OODScoreModelMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.models.mixins.</span></span><span class="sig-name descname"><span class="pre">OODScoreModelMixin</span></span><a class="reference internal" href="_modules/shifthappens/models/mixins.html#OODScoreModelMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.mixins.OODScoreModelMixin" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Inherit from this class if your model returns ood scores.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.models.mixins.FeaturesModelMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.models.mixins.</span></span><span class="sig-name descname"><span class="pre">FeaturesModelMixin</span></span><a class="reference internal" href="_modules/shifthappens/models/mixins.html#FeaturesModelMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.mixins.FeaturesModelMixin" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Inherit from this class if your model returns features.</p>
</dd></dl>

<section id="module-shifthappens.models.torchvision">
<span id="model-implementations-from-torchvision"></span><h4>Model implementations from torchvision<a class="headerlink" href="#module-shifthappens.models.torchvision" title="Permalink to this heading">#</a></h4>
<p>Model baselines from torchvision.</p>
<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.models.torchvision.__TorchvisionPreProcessingMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.models.torchvision.</span></span><span class="sig-name descname"><span class="pre">__TorchvisionPreProcessingMixin</span></span><a class="reference internal" href="_modules/shifthappens/models/torchvision.html#__TorchvisionPreProcessingMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.torchvision.__TorchvisionPreProcessingMixin" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Performs the default preprocessing for torchvision ImageNet classifiers.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.models.torchvision.__TorchvisionModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.models.torchvision.</span></span><span class="sig-name descname"><span class="pre">__TorchvisionModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/models/torchvision.html#__TorchvisionModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.torchvision.__TorchvisionModel" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shifthappens.models.base.Model" title="shifthappens.models.base.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>, <a class="reference internal" href="#shifthappens.models.torchvision.__TorchvisionPreProcessingMixin" title="shifthappens.models.torchvision.__TorchvisionPreProcessingMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">__TorchvisionPreProcessingMixin</span></code></a>, <a class="reference internal" href="#shifthappens.models.mixins.LabelModelMixin" title="shifthappens.models.mixins.LabelModelMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">LabelModelMixin</span></code></a>, <a class="reference internal" href="#shifthappens.models.mixins.ConfidenceModelMixin" title="shifthappens.models.mixins.ConfidenceModelMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfidenceModelMixin</span></code></a>, <a class="reference internal" href="#shifthappens.models.mixins.FeaturesModelMixin" title="shifthappens.models.mixins.FeaturesModelMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeaturesModelMixin</span></code></a>, <a class="reference internal" href="#shifthappens.models.mixins.OODScoreModelMixin" title="shifthappens.models.mixins.OODScoreModelMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">OODScoreModelMixin</span></code></a></p>
<p>Wraps a torchvision model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v1.11.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a>) – Pretrained torchvision model.</p></li>
<li><p><strong>max_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – How many samples allowed per batch to load.</p></li>
<li><p><strong>feature_layer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the layer that shall be used to extract features/representations..</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">'cpu'</span></code>) – Selected device to run the model on.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="shifthappens.models.torchvision.__TorchvisionModel._predict">
<span class="sig-name descname"><span class="pre">_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shifthappens.models.torchvision.__TorchvisionModel._predict" title="Permalink to this definition">#</a></dt>
<dd><p>Override this function for the specific model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dataloader</strong> (<a class="reference internal" href="#shifthappens.data.base.DataLoader" title="shifthappens.data.base.DataLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></a>) – Dataloader producing batches of data.</p></li>
<li><p><strong>targets</strong> (<a class="reference internal" href="#shifthappens.models.base.PredictionTargets" title="shifthappens.models.base.PredictionTargets"><code class="xref py py-class docutils literal notranslate"><span class="pre">PredictionTargets</span></code></a>) – Indicates which kinds of targets should be predicted.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterator</span></code></a>[<a class="reference internal" href="#shifthappens.models.base.ModelResult" title="shifthappens.models.base.ModelResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelResult</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Yields prediction results for all batches yielded by the dataloader.
Depending on the target arguments the model results may include the
predicted labels, class confidences, class uncertainties, ood scores,
and image features, all as <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> objects.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.models.torchvision.ResNet18">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.models.torchvision.</span></span><span class="sig-name descname"><span class="pre">ResNet18</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/models/torchvision.html#ResNet18"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.torchvision.ResNet18" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shifthappens.models.torchvision.__TorchvisionModel" title="shifthappens.models.torchvision.__TorchvisionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">__TorchvisionModel</span></code></a></p>
<p>ResNet18 network trained on the ImageNet 2012 train set from torchvision.
See <a class="reference external" href="https://pytorch.org/vision/stable/generated/torchvision.models.resnet18.html#torchvision.models.resnet18" title="(in Torchvision vmain (0.12.0a0+9b5a3fe ))"><code class="xref py py-func docutils literal notranslate"><span class="pre">torchvision.models.resnet18</span></code></a> for details.
:type max_batch_size: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">16</span></code>
:param max_batch_size: How many samples allowed per batch to load.
:type device: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">'cpu'</span></code>
:param device: Selected device to run the model on.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.models.torchvision.ResNet50">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.models.torchvision.</span></span><span class="sig-name descname"><span class="pre">ResNet50</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/models/torchvision.html#ResNet50"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.torchvision.ResNet50" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shifthappens.models.torchvision.__TorchvisionModel" title="shifthappens.models.torchvision.__TorchvisionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">__TorchvisionModel</span></code></a></p>
<p>Load a ResNet50 network trained on the ImageNet 2012 train set from torchvision.
See <a class="reference external" href="https://pytorch.org/vision/stable/generated/torchvision.models.resnet50.html#torchvision.models.resnet50" title="(in Torchvision vmain (0.12.0a0+9b5a3fe ))"><code class="xref py py-func docutils literal notranslate"><span class="pre">torchvision.models.resnet50</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">16</span></code>) – How many samples allowed per batch to load.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">'cpu'</span></code>) – Selected device to run the model on.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.models.torchvision.VGG16">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.models.torchvision.</span></span><span class="sig-name descname"><span class="pre">VGG16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/models/torchvision.html#VGG16"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.models.torchvision.VGG16" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shifthappens.models.torchvision.__TorchvisionModel" title="shifthappens.models.torchvision.__TorchvisionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">__TorchvisionModel</span></code></a></p>
<p>Load a VGG16 network trained on the ImageNet 2012 train set from torchvision.
See <a class="reference external" href="https://pytorch.org/vision/stable/generated/torchvision.models.vgg16.html#torchvision.models.vgg16" title="(in Torchvision vmain (0.12.0a0+9b5a3fe ))"><code class="xref py py-func docutils literal notranslate"><span class="pre">torchvision.models.vgg16</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">16</span></code>) – How many samples allowed per batch to load.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">'cpu'</span></code>) – Selected device to run the model on.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-shifthappens.data.base">
<span id="data-loading"></span><h3>Data loading<a class="headerlink" href="#module-shifthappens.data.base" title="Permalink to this heading">#</a></h3>
<p>Base classes and helper functions for data handling (dataset, dataloader).</p>
<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.data.base.Dataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.data.base.</span></span><span class="sig-name descname"><span class="pre">Dataset</span></span><a class="reference internal" href="_modules/shifthappens/data/base.html#Dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.data.base.Dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>An abstract class representing an <a class="reference external" href="https://pytorch.org/docs/stable/data.html#iterable-style-datasets">iterable dataset</a>.
Your iterable datasets should be inherited from this class.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.data.base.IndexedDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.data.base.</span></span><span class="sig-name descname"><span class="pre">IndexedDataset</span></span><a class="reference internal" href="_modules/shifthappens/data/base.html#IndexedDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.data.base.IndexedDataset" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shifthappens.data.base.Dataset" title="shifthappens.data.base.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a></p>
<p>A class representing a <a class="reference external" href="https://pytorch.org/docs/stable/data.html#map-style-datasets">map-style dataset</a>.
Your map-style datasets should be inherited from this class.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.data.base.DataLoader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.data.base.</span></span><span class="sig-name descname"><span class="pre">DataLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/data/base.html#DataLoader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.data.base.DataLoader" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Interface b/w model and task, implements restrictions
(e.g. max batch size) for models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="#shifthappens.data.base.Dataset" title="shifthappens.data.base.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a>) – Dataset from which to load the data.</p></li>
<li><p><strong>max_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – How many samples allowed per batch to load.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shifthappens.data.base.shuffle_data">
<span class="sig-prename descclassname"><span class="pre">shifthappens.data.base.</span></span><span class="sig-name descname"><span class="pre">shuffle_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/data/base.html#shuffle_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.data.base.shuffle_data" title="Permalink to this definition">#</a></dt>
<dd><p>Randomly shuffles without replacement an <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>/list of
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> objects with a fixed random seed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>], <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]) – Data to shuffle.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Random seed.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>], <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-shifthappens.data.torch"></span><p>Wrappers for PyTorch datasets such that they can be used as datasets
for the benchmark.</p>
<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.data.torch.TorchDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.data.torch.</span></span><span class="sig-name descname"><span class="pre">TorchDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/data/torch.html#TorchDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.data.torch.TorchDataset" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shifthappens.data.base.Dataset" title="shifthappens.data.base.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a></p>
<p>Wraps a torch iterable dataset
(i.e. <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.IterableDataset" title="(in PyTorch v1.11.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.IterableDataset</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>torch_dataset</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.IterableDataset" title="(in PyTorch v1.11.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">IterableDataset</span></code></a>) – Dataset from which to load the data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.data.torch.IndexedTorchDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.data.torch.</span></span><span class="sig-name descname"><span class="pre">IndexedTorchDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/data/torch.html#IndexedTorchDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.data.torch.IndexedTorchDataset" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shifthappens.data.base.IndexedDataset" title="shifthappens.data.base.IndexedDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexedDataset</span></code></a></p>
<p>Wraps a torch map-style dataset
(i.e. <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v1.11.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.Dataset</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>torch_dataset</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v1.11.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a>) – Dataset from which to load the data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.data.torch.ImagesOnlyTorchDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.data.torch.</span></span><span class="sig-name descname"><span class="pre">ImagesOnlyTorchDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/data/torch.html#ImagesOnlyTorchDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.data.torch.ImagesOnlyTorchDataset" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v1.11.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a></p>
<p>Wraps a torch map-style dataset returning images and labels such that
only the images are returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v1.11.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a>) – Dataset from which to load the data.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-shifthappens.task_data.task_metadata">
<span id="storing-tasks-within-the-benchmark"></span><h3>Storing tasks within the benchmark<a class="headerlink" href="#module-shifthappens.task_data.task_metadata" title="Permalink to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="shifthappens.task_data.task_metadata.TaskMetadata">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.task_data.task_metadata.</span></span><span class="sig-name descname"><span class="pre">TaskMetadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_data_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standalone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/task_data/task_metadata.html#TaskMetadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.task_data.task_metadata.TaskMetadata" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for storing a task’s metadata required by the task registration mechanism.
Arguments are passed by <a class="reference internal" href="#shifthappens.benchmark.register_task" title="shifthappens.benchmark.register_task"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shifthappens.benchmark.register_task</span></code></a> and are the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the task (can contain spaces or special characters).</p></li>
<li><p><strong>relative_data_folder</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the folder in which the data for
this dataset will be saved for this task relative to the root folder
of the benchmark.</p></li>
<li><p><strong>standalone</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Boolean which represents if this task meaningful as a
standalone task or will this only be relevant as a part of a
collection of tasks.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-shifthappens.task_data.task_registration"></span><dl class="py class">
<dt class="sig sig-object py" id="shifthappens.task_data.task_registration.TaskRegistration">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shifthappens.task_data.task_registration.</span></span><span class="sig-name descname"><span class="pre">TaskRegistration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shifthappens/task_data/task_registration.html#TaskRegistration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#shifthappens.task_data.task_registration.TaskRegistration" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for storing a task’s registration for the benchmark. Arguments initialized
automatically during task registration process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code></a>[<a class="reference internal" href="#shifthappens.tasks.base.Task" title="shifthappens.tasks.base.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code></a>]) – Task class.</p></li>
<li><p><strong>metadata</strong> (<a class="reference internal" href="#shifthappens.task_data.task_metadata.TaskMetadata" title="shifthappens.task_data.task_metadata.TaskMetadata"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskMetadata</span></code></a>) – Task metadata passed with <a class="reference internal" href="#shifthappens.benchmark.register_task" title="shifthappens.benchmark.register_task"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shifthappens.benchmark.register_task</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>


              </article>
              

              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2021 - 2022, Julian Bitterwolf, Evgenia Rusak, Steffen Schneider, Roland S. Zimmermann and contributors. Released under an Apache 2.0 License.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.0.2.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>